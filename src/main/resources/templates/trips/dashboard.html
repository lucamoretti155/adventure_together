<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Tutti i Viaggi</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
</head>
<body>

<div th:replace="~{fragments/navbar :: mainNavbar}"></div>

<div class="container my-5">

    <h1 class="mb-4 fw-bold">Esplora tutti i nostri viaggi</h1>

    <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>
    <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>

    <div class="row">

        <!-- FILTRI -->
        <div class="col-md-4">
            <div class="border rounded p-3 bg-light">

                <!-- CATEGORIE -->
                <h5 class="fw-bold">Categorie</h5>
                <form th:action="@{/trips/categories}" method="get">
                    <div th:each="cat : ${categories}">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox"
                                   name="categoryIds"
                                   th:value="${cat.id}">
                            <label class="form-check-label"
                                   th:text="${cat.name}"></label>
                        </div>
                    </div>

                    <button class="btn btn-primary btn-sm mt-3">Filtra per categoria</button>
                </form>


                <!-- GEO AREE + PAESI ANNIDATI -->
                <h5 class="fw-bold mt-4">Aree Geografiche</h5>

                <ul class="list-unstyled">

                    <li th:each="area : ${geoAreas}" class="mb-2">

                        <!-- Nome GeoArea -->
                        <a th:href="@{'/trips/geo-area/' + ${area.id}}"
                           class="text-decoration-none text-muted fw-bold d-block mb-1">
                            <span th:text="${area.geoArea}"></span>
                        </a>

                        <!-- Lista Paesi associati -->
                        <ul class="list-unstyled ms-3">

                            <!-- contatore -->
                            <li th:with="found=0"></li>

                            <!-- mostra countries della geoarea -->
                            <li th:each="c, iter : ${countries}"
                                th:if="${c.geoAreaId == area.id}"
                                th:with="found=${iter.index + 1}">

                                <a th:href="@{'/trips/country/' + ${c.id}}"
                                   class="text-decoration-none text-muted">
                                    <span th:text="${c.country}"></span>
                                </a>

                            </li>

                            <!-- Nessun paese -->
                            <li th:if="${found == 0}" class="text-muted small fst-italic">
                                Nessun paese disponibile
                            </li>

                        </ul>

                    </li>

                </ul>


            </div>
        </div>

        <!-- DESCRIZIONE A DESTRA -->
        <div class="col-md-8 d-flex align-items-center">
            <div class="p-4">
                <h4 class="fw-bold">Come usare i filtri</h4>
                <p class="text-muted">
                    Seleziona una o più categorie, oppure scegli una specifica area geografica
                    o un paese.
                    Verrai reindirizzato alla pagina con tutti gli itinerari che soddisfano
                    il criterio selezionato.
                </p>

                <p class="text-muted">
                    La dashboard principale non mostra automaticamente tutti i viaggi,
                    per mantenere la navigazione più pulita e intuitiva.
                </p>
            </div>
        </div>

    </div>

</div>

</body>
</html>

